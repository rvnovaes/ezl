{% extends 'base.html' %}
{% load staticfiles %}
{% block content %}

    <style>
        tbody > tr > td{
            font-weight: 300 !important;
        }

        thead > tr > th{
            font-weight: 400 !important;
        }
        thead{
            background-color: #eee !important;
        }
    </style>
    {% if messages %}
        <script>
            $(document).ready(function(){
                // the "href" attribute of .modal-trigger must specify the modal ID that wants to be triggered
                $('.modal').modal();
            });
        </script>
        <!-- Modal Structure -->
        <ul class="messages">
            {% for message in messages %}
                <script type="text/javascript">
                    $.toast({
                        text: '<center><font size=3>{{ message }}</font></center>',
                        allowToastClose : false,
                        hideAfter : 5000,
                        position : 'bottom-center',
                        loader: false,
                        stack: 5
                    })
                </script>
            {% endfor %}
        </ul>
    {% endif %}
    <div class="container">
    {% if instances == None %}
        <div id="center"> Nenhuma instância cadastrada. <a href="/processos/nova_instancia/">Cadastrar agora</a>.</div>

    {% else %}
        <a class="tooltipped btn-floating align-right waves-effect waves-light btn" style="float: right !important;" data-tooltip="Nova Instância" data-positivon="bottom" href="/processos/nova_instancia/" onclick="$('.modal').modal();"><i class="material-icons left">add</i></a>
        <br><br>
        <table class="bordered highlight centered">
            <thead>
            <tr>
                <th>Nome da Instância</th>
                <th>Ação</th>
            </tr>
            </thead>
            <tbody>
            {% for instance in instances %}
                <tr>
                    <td>{{instance.name}}</td>

                    <!-- Gera uma janela modal de exclusão para cada item -->
                    <div id="modal_apagar{{instance.id}}" class="modal">
                        <div class="modal-content">
                            <h4>Atenção</h4>
                            <p>Tem certeza que deseja apagar esta instância ?</p>
                        </div>
                        <div class="modal-footer">
                            <a href="/processos/instancias/apagar/{{instance.id}}" class="modal-action waves-effect waves-green btn-flat">Sim</a>
                            <a href="#!" class="modal-action modal-close waves-effect waves-green btn-flat">Não</a>
                        </div>
                    </div>

                    <!-- Gera uma janela modal de edição para cada item -->
                    <div id="modal_edit{{instance.id}}" class="modal">
                        <div class="modal-content">
                            <form action="localhost:8000/processos/instancias/editar_instancia/{{instance.id}}" method="post">
                                {% csrf_token %}

                                <input value="{{instance.name}}" placeholder="Nome da Instância" type="text" name="name" maxlength="255">
                                <input type="submit" value="Salvar" class="modal-action waves-effect waves-green btn-flat">
                                <a href="#!" class="modal-action modal-close waves-effect waves-green btn-flat">Não</a>
                            </form>
                        </div>
                    </div>&nbsp;&nbsp;&nbsp;

                    <td>
                        <a href="#modal_apagar{{instance.id}}" onclick="$('.modal').modal();">
                            <i class="material-icons tooltipped" data-position="top" data-tooltip="Excluir" style="color: #bf0000">cancel</i>
                        </a> &nbsp;&nbsp;
                        <a href="/processos/instancias/editar_instancia/{{ instance.id }}" onclick="$('.modal').modal();">
                            <i class="material-icons tooltipped" data-position="top" data-tooltip="Editar" style="color: #ffbb3f">mode_edit</i>
                        </a>
                    </td>
                </tr>
            {% endfor %}

            </tbody>
        </table>
    {% endif %}
{% endblock %}
<div>